% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prediction.r
\name{run_elastic_net_model_cv}
\alias{run_elastic_net_model_cv}
\title{Run Elastic Net Model with Cross-Validation}
\usage{
run_elastic_net_model_cv(
  idps,
  trait,
  age,
  conf,
  conf_names,
  trait_id,
  remove_age,
  model_age,
  alpha = 1,
  n_folds = 10
)
}
\arguments{
\item{idps}{A matrix of IDP (input data) features.}

\item{trait}{A vector of target variable (traits) to predict.}

\item{age}{A vector of ages corresponding to the observations.}

\item{conf}{A matrix of confounding variables to be removed (optional).}

\item{conf_names}{Column names for the confound matrix.}

\item{trait_id}{Trait identifier used in pre-processing.}

\item{remove_age}{Logical, whether to remove age effect during pre-processing.}

\item{model_age}{Integer to specify how age is treated in the model:
0 = No age, 1 = Age as a covariate, 2 = Age only, 3 = IDPs + Age.}

\item{alpha}{Elastic net mixing parameter (0 = ridge, 1 = lasso).}

\item{n_folds}{Number of cross-validation folds.}
}
\value{
A list containing:
\item{yhat}{Predicted values for all samples across the test folds.}
\item{corr_train}{Training set correlations for each fold.}
\item{corr_test}{Test set correlations for each fold.}
\item{models}{List of fitted Elastic Net models for each fold.}
\item{trait_transformed}{Transformed trait used during cross-validation.}
}
\description{
Performs k-fold cross-validation using Elastic Net, predicting the trait from IDP data
with optional inclusion of age as a covariate.
}
